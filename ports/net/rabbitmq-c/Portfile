# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0
PortGroup       cmake 1.0
PortGroup       github 1.0

name            rabbitmq-c
categories      net devel
version         0.5.0
revision        1
license         MIT
maintainers     openmaintainer
platforms       darwin

github.setup    alanxz ${name} ${version} v

description     RabbitMQ C client
long_description \
   This is a C-language AMQP client library for use \
   with AMQP servers speaking protocol versions 0-9-1.

checksums \
    rmd160  85d4bbb5cae9f1855f01efecc1625b7d279082f0 \
    sha256  72b5b5075d5de834b4eaef1e77d675be2f926206d1ccd2bc886b2deff869f318

configure.args  -DBUILD_STATIC_LIBS:BOOL=ON \
                -DBUILD_TOOLS:BOOL=OFF \
                -DBUILD_TOOLS_DOCS:BOOL=OFF

variant tools description {Install RabbitMQ C Client Tools} {
    configure.args-delete   -DBUILD_TOOLS:BOOL=OFF
    #                        -DBUILD_TOOLS_DOCS:BOOL=OFF
    configure.args-append   -DBUILD_TOOLS:BOOL=ON
    #                        -DBUILD_TOOLS_DOCS:BOOL=ON
    #depends_build-append    port:xmlto
    depends_lib-append      port:popt
}

pre-configure {
    if {[file exists ${prefix}/include/amqp.h]} {
        ui_error "${name} cannot be built while ${name} is active."
        ui_error "Please deactivate ${name} and try again."
        return -code error "${name} is installed"
    }
}
