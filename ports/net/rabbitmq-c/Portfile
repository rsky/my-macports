# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0
PortGroup       cmake 1.0
PortGroup       github 1.0

name            rabbitmq-c
categories      net devel
version         0.5.2
revision        0
license         MIT
maintainers     openmaintainer
platforms       darwin

github.setup    alanxz ${name} ${version} v

description     RabbitMQ C client
long_description \
   This is a C-language AMQP client library for use \
   with AMQP servers speaking protocol versions 0-9-1.

checksums \
    rmd160  ccff7fd0b3b0e59a5562a4d35b7e12858357309b \
    sha256  d964f7a7c0a0bf602fb4ba74abdf23f1d064495aadf36b51854fd5b09b4f9887

configure.args  -DBUILD_STATIC_LIBS:BOOL=ON \
                -DBUILD_TOOLS:BOOL=OFF \
                -DBUILD_TOOLS_DOCS:BOOL=OFF

variant tools description {Install RabbitMQ C Client Tools} {
    configure.args-delete   -DBUILD_TOOLS:BOOL=OFF
    #                        -DBUILD_TOOLS_DOCS:BOOL=OFF
    configure.args-append   -DBUILD_TOOLS:BOOL=ON
    #                        -DBUILD_TOOLS_DOCS:BOOL=ON
    #depends_build-append    port:xmlto
    depends_lib-append      port:popt
}

pre-configure {
    if {[file exists ${prefix}/include/amqp.h]} {
        ui_error "${name} cannot be built while ${name} is active."
        ui_error "Please deactivate ${name} and try again."
        return -code error "${name} is installed"
    }
}
