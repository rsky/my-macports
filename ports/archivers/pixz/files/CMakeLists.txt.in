cmake_minimum_required(VERSION 2.8.9)
project(pixz)
set(pixz_VERSION %VERSION%)

find_package(LibLZMA REQUIRED)
find_package(LibArchive REQUIRED)

set(PIXZ_COMMON_SOURCES common.c endian.c cpu.c read.c write.c list.c)
set(PIXZ_BINDIR bin)
set(PIXZ_MANDIR share/man)

add_definitions("-DPIXZ_VERSION=\"${pixz_VERSION}\"")
include_directories(${LIBLZMA_INCLUDE_DIRS} ${LibArchive_INCLUDE_DIRS})

add_executable(pixz pixz.c ${PIXZ_COMMON_SOURCES})
target_link_libraries(pixz
    pthread ${LIBLZMA_LIBRARIES} ${LibArchive_LIBRARIES}
)

install(TARGETS pixz RUNTIME DESTINATION ${PIXZ_BINDIR})
install_files(/${PIXZ_MANDIR}/man1 FILES pixz.1)
